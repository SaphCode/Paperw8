{% extends 'base.html' %}

{% block title %}Blog{% endblock %}

{% block content %}

	<div class="container-fluid p-0 m-0 bg-light">
		<img src="{{url_for('static', filename='images/bp_banner_hq.png')}}" class="img-fluid"></img>
	</div>

	<div class="container-fluid bg-light m-0 p-0">
		<div class="d-flex justify-content-center pt-5">
			<div class="col-md-4 d-flex justify-content-center">
				<div class="btn-group d-flex justify-content-center" role="group" aria-label="Button group with nested dropdown">
					<a type="button" href="{{ url_for('blog.blog', group_by='all', sort_by=sort_by, page=1) }}" class="btn btn-sm btn-outline-dark btn-lg {% if group_by == 'all' %} active {% endif %}">All</a>
					<a type="button" href="{{ url_for('blog.blog', group_by='business', sort_by=sort_by, page=1) }}" class="btn btn-sm btn-outline-dark btn-lg {% if group_by == 'business' %} active {% endif %}" class="btn btn-outline-danger btn-lg">Businesses</a>
					<a type="button" href="{{ url_for('blog.blog', group_by='book', sort_by=sort_by, page=1) }}" class="btn btn-sm btn-outline-dark btn-lg {% if group_by == 'book' %} active {% endif %}" class="btn btn-outline-danger btn-lg">Book reviews</a>
					<a type="button" href="{{ url_for('blog.blog', group_by='annual', sort_by=sort_by, page=1) }}" class="btn btn-sm btn-outline-dark btn-lg {% if group_by == 'annual' %} active {% endif %}" class="btn btn-outline-danger btn-lg">Annual letters</a>

					<div class="btn-group" role="group">
						<button id="btnGroupDrop1" type="button" class="btn btn-sm btn-outline-dark btn-lg dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
						Sort
						</button>
						<ul class="dropdown-menu" aria-labelledby="btnGroupDrop1">
							<li><a class="dropdown-item {% if sort_by == 'date_desc' %} active {% endif %}" href="{{ url_for('blog.blog', group_by=group_by, sort_by='date_desc', page=page) }}">New to old</a></li>
							<li><a class="dropdown-item {% if sort_by == 'date_asc' %} active {% endif %}" href="{{ url_for('blog.blog', group_by=group_by, sort_by='date_asc', page=page) }}">Old to new</a></li>
							<li><a class="dropdown-item {% if sort_by == 'title_desc' %} active {% endif %}" href="{{ url_for('blog.blog', group_by=group_by, sort_by='title_desc', page=page) }}">A to Z</a></li>
							<li><a class="dropdown-item {% if sort_by == 'title_asc' %} active {% endif %}" href="{{ url_for('blog.blog', group_by=group_by, sort_by='title_asc', page=page) }}">Z to A</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		{% if g.user %}
		<div class="d-flex align-items-center justify-content-center pt-5">
			<div class="d-flex align-items-center justify-content-center col-md-2">
				<a type="button" class="w-100 btn btn-lg btn-primary" href="{{ url_for('blog.create') }}">Create</a>
			</div>
		</div>
		{% endif %}
	
		{% for post in posts %}
			<div class="row-auto d-flex justify-content-center mt-4">
				{% if g.user['id'] == post['author_id'] or g.user['username'] == 'admin' %}
					<a class="action text-decoration-none" href="{{ url_for('blog.update', id=post['id']) }}" style="color:white">
						<div class="col-md-1 bg-danger d-flex justify-content-center align-items-center" style="width:5em; height:100%;">
						Edit
						</div>
					</a>
				{% endif %}
			
			<article class="col-md-7 all {{ post['category'] }}">
				<div class="bg-white row g-0 border rounded overflow-hidden flex-md-row shadow-sm h-md-250 position-relative">
					<div class="col d-flex flex-column position-static">
						<div class="p-3">
							<strong class="d-inline-block mb-2" style="color:#e03444">{{ post['category'].capitalize() }}</strong>
							<h1 class="blog_title">{{ post['title'] }}</h1>
							<div class="mb-1 text-muted">by {{ post['display_name'] }} on {{ post['created'].strftime('%Y-%m-%d') }}</div>
							{% if post['created'].strftime('%Y-%m-%d') != post['last_edit'].strftime('%Y-%m-%d') %}
							
							<div class="about font-italic">
								last edit on {{ post['last_edit'].strftime('%Y-%m-%d') }}{% endif %}
								<a href="{{ url_for('blog.post', id=post['id']) }}" class="stretched-link text-decoration-none" style="color:#e03444">Read</a>
							</div>
							
						</div>
						<div class="col-auto d-none d-lg-block">
							<img src="{{url_for('static', filename='images/' + post['title_img_parent_dir'] + '/' + post['title_img'])}}" width='auto' height='250px'></img></svg>
						</div>
					</div>
				</div>
			</article>
		</div>
	  {% endfor %}
	  
		<div class="container d-flex justify-content-center bg-light mt-4 pb-6">
			<a {% if (max_posts <= (page+1)*5) %} {% endif %} type="button" class="btn btn-dark" href="{{ url_for('blog.blog', group_by=group_by, sort_by=sort_by, page=page+1) }}">Older Posts</a>
		</div>
	</div>	

{% endblock %}




